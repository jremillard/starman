#include <math.h>
#include <stdio.h>
#include "fast_mat.h"

const float PI = 3.1415926;

static int angle;

float sin_lookup[] = {
	 0.0000000e+00,
	 1.7452406e-02,
	 3.4899497e-02,
	 5.2335956e-02,
	 6.9756474e-02,
	 8.7155743e-02,
	 1.0452846e-01,
	 1.2186934e-01,
	 1.3917310e-01,
	 1.5643447e-01,
	 1.7364818e-01,
	 1.9080900e-01,
	 2.0791169e-01,
	 2.2495105e-01,
	 2.4192190e-01,
	 2.5881905e-01,
	 2.7563736e-01,
	 2.9237170e-01,
	 3.0901699e-01,
	 3.2556815e-01,
	 3.4202014e-01,
	 3.5836795e-01,
	 3.7460659e-01,
	 3.9073113e-01,
	 4.0673664e-01,
	 4.2261826e-01,
	 4.3837115e-01,
	 4.5399050e-01,
	 4.6947156e-01,
	 4.8480962e-01,
	 5.0000000e-01,
	 5.1503807e-01,
	 5.2991926e-01,
	 5.4463904e-01,
	 5.5919290e-01,
	 5.7357644e-01,
	 5.8778525e-01,
	 6.0181502e-01,
	 6.1566148e-01,
	 6.2932039e-01,
	 6.4278761e-01,
	 6.5605903e-01,
	 6.6913061e-01,
	 6.8199836e-01,
	 6.9465837e-01,
	 7.0710678e-01,
	 7.1933980e-01,
	 7.3135370e-01,
	 7.4314483e-01,
	 7.5470958e-01,
	 7.6604444e-01,
	 7.7714596e-01,
	 7.8801075e-01,
	 7.9863551e-01,
	 8.0901699e-01,
	 8.1915204e-01,
	 8.2903757e-01,
	 8.3867057e-01,
	 8.4804810e-01,
	 8.5716730e-01,
	 8.6602540e-01,
	 8.7461971e-01,
	 8.8294759e-01,
	 8.9100652e-01,
	 8.9879405e-01,
	 9.0630779e-01,
	 9.1354546e-01,
	 9.2050485e-01,
	 9.2718385e-01,
	 9.3358043e-01,
	 9.3969262e-01,
	 9.4551858e-01,
	 9.5105652e-01,
	 9.5630476e-01,
	 9.6126170e-01,
	 9.6592583e-01,
	 9.7029573e-01,
	 9.7437006e-01,
	 9.7814760e-01,
	 9.8162718e-01,
	 9.8480775e-01,
	 9.8768834e-01,
	 9.9026807e-01,
	 9.9254615e-01,
	 9.9452190e-01,
	 9.9619470e-01,
	 9.9756405e-01,
	 9.9862953e-01,
	 9.9939083e-01,
	 9.9984770e-01,
	 1.0000000e+00,
	 9.9984770e-01,
	 9.9939083e-01,
	 9.9862953e-01,
	 9.9756405e-01,
	 9.9619470e-01,
	 9.9452190e-01,
	 9.9254615e-01,
	 9.9026807e-01,
	 9.8768834e-01,
	 9.8480775e-01,
	 9.8162718e-01,
	 9.7814760e-01,
	 9.7437006e-01,
	 9.7029573e-01,
	 9.6592583e-01,
	 9.6126170e-01,
	 9.5630476e-01,
	 9.5105652e-01,
	 9.4551858e-01,
	 9.3969262e-01,
	 9.3358043e-01,
	 9.2718385e-01,
	 9.2050485e-01,
	 9.1354546e-01,
	 9.0630779e-01,
	 8.9879405e-01,
	 8.9100652e-01,
	 8.8294759e-01,
	 8.7461971e-01,
	 8.6602540e-01,
	 8.5716730e-01,
	 8.4804810e-01,
	 8.3867057e-01,
	 8.2903757e-01,
	 8.1915204e-01,
	 8.0901699e-01,
	 7.9863551e-01,
	 7.8801075e-01,
	 7.7714596e-01,
	 7.6604444e-01,
	 7.5470958e-01,
	 7.4314483e-01,
	 7.3135370e-01,
	 7.1933980e-01,
	 7.0710678e-01,
	 6.9465837e-01,
	 6.8199836e-01,
	 6.6913061e-01,
	 6.5605903e-01,
	 6.4278761e-01,
	 6.2932039e-01,
	 6.1566148e-01,
	 6.0181502e-01,
	 5.8778525e-01,
	 5.7357644e-01,
	 5.5919290e-01,
	 5.4463904e-01,
	 5.2991926e-01,
	 5.1503807e-01,
	 5.0000000e-01,
	 4.8480962e-01,
	 4.6947156e-01,
	 4.5399050e-01,
	 4.3837115e-01,
	 4.2261826e-01,
	 4.0673664e-01,
	 3.9073113e-01,
	 3.7460659e-01,
	 3.5836795e-01,
	 3.4202014e-01,
	 3.2556815e-01,
	 3.0901699e-01,
	 2.9237170e-01,
	 2.7563736e-01,
	 2.5881905e-01,
	 2.4192190e-01,
	 2.2495105e-01,
	 2.0791169e-01,
	 1.9080900e-01,
	 1.7364818e-01,
	 1.5643447e-01,
	 1.3917310e-01,
	 1.2186934e-01,
	 1.0452846e-01,
	 8.7155743e-02,
	 6.9756474e-02,
	 5.2335956e-02,
	 3.4899497e-02,
	 1.7452406e-02,
	 1.2246064e-16,
	-1.7452406e-02,
	-3.4899497e-02,
	-5.2335956e-02,
	-6.9756474e-02,
	-8.7155743e-02,
	-1.0452846e-01,
	-1.2186934e-01,
	-1.3917310e-01,
	-1.5643447e-01,
	-1.7364818e-01,
	-1.9080900e-01,
	-2.0791169e-01,
	-2.2495105e-01,
	-2.4192190e-01, 
	-2.5881905e-01,
	-2.7563736e-01,
	-2.9237170e-01,
	-3.0901699e-01,
	-3.2556815e-01,
	-3.4202014e-01,
	-3.5836795e-01,
	-3.7460659e-01,
	-3.9073113e-01,
	-4.0673664e-01,
	-4.2261826e-01,
	-4.3837115e-01,
	-4.5399050e-01,
	-4.6947156e-01,
	-4.8480962e-01,
	-5.0000000e-01,
	-5.1503807e-01,
	-5.2991926e-01,
	-5.4463904e-01,
	-5.5919290e-01,
	-5.7357644e-01,
	-5.8778525e-01,
	-6.0181502e-01,
	-6.1566148e-01,
	-6.2932039e-01,
	-6.4278761e-01,
	-6.5605903e-01,
	-6.6913061e-01,
	-6.8199836e-01,
	-6.9465837e-01,
	-7.0710678e-01,
	-7.1933980e-01,
	-7.3135370e-01,
	-7.4314483e-01,
	-7.5470958e-01,
	-7.6604444e-01,
	-7.7714596e-01,
	-7.8801075e-01,
	-7.9863551e-01,
	-8.0901699e-01,
	-8.1915204e-01,
	-8.2903757e-01,
	-8.3867057e-01,
	-8.4804810e-01,
	-8.5716730e-01,
	-8.6602540e-01,
	-8.7461971e-01,
	-8.8294759e-01,
	-8.9100652e-01,
	-8.9879405e-01,
	-9.0630779e-01,
	-9.1354546e-01,
	-9.2050485e-01,
	-9.2718385e-01,
	-9.3358043e-01,
	-9.3969262e-01,
	-9.4551858e-01,
	-9.5105652e-01,
	-9.5630476e-01,
	-9.6126170e-01,
	-9.6592583e-01,
	-9.7029573e-01,
	-9.7437006e-01,
	-9.7814760e-01,
	-9.8162718e-01,
	-9.8480775e-01,
	-9.8768834e-01,
	-9.9026807e-01,
	-9.9254615e-01,
	-9.9452190e-01,
	-9.9619470e-01,
	-9.9756405e-01,
	-9.9862953e-01,
	-9.9939083e-01,
	-9.9984770e-01,
	-1.0000000e+00,
	-9.9984770e-01,
	-9.9939083e-01,
	-9.9862953e-01,
	-9.9756405e-01,
	-9.9619470e-01,
	-9.9452190e-01,
	-9.9254615e-01,
	-9.9026807e-01,
	-9.8768834e-01,
	-9.8480775e-01,
	-9.8162718e-01,
	-9.7814760e-01,
	-9.7437006e-01,
	-9.7029573e-01,
	-9.6592583e-01,
	-9.6126170e-01,
	-9.5630476e-01,
	-9.5105652e-01,
	-9.4551858e-01,
	-9.3969262e-01,
	-9.3358043e-01,
	-9.2718385e-01,
	-9.2050485e-01,
	-9.1354546e-01,
	-9.0630779e-01,
	-8.9879405e-01,
	-8.9100652e-01,
	-8.8294759e-01,
	-8.7461971e-01,
	-8.6602540e-01,
	-8.5716730e-01,
	-8.4804810e-01,
	-8.3867057e-01,
	-8.2903757e-01,
	-8.1915204e-01,
	-8.0901699e-01,
	-7.9863551e-01,
	-7.8801075e-01,
	-7.7714596e-01,
	-7.6604444e-01,
	-7.5470958e-01,
	-7.4314483e-01,
	-7.3135370e-01,
	-7.1933980e-01,
	-7.0710678e-01,
	-6.9465837e-01,
	-6.8199836e-01,
	-6.6913061e-01,
	-6.5605903e-01,
	-6.4278761e-01,
	-6.2932039e-01,
	-6.1566148e-01,
	-6.0181502e-01,
	-5.8778525e-01,
	-5.7357644e-01,
	-5.5919290e-01,
	-5.4463904e-01,
	-5.2991926e-01,
	-5.1503807e-01,
	-5.0000000e-01,
	-4.8480962e-01,
	-4.6947156e-01,
	-4.5399050e-01,
	-4.3837115e-01,
	-4.2261826e-01,
	-4.0673664e-01,
	-3.9073113e-01,
	-3.7460659e-01,
	-3.5836795e-01,
	-3.4202014e-01,
	-3.2556815e-01,
	-3.0901699e-01 ,
	-2.9237170e-01,
	-2.7563736e-01,
	-2.5881905e-01,
	-2.4192190e-01,
	-2.2495105e-01,
	-2.0791169e-01,
	-1.9080900e-01,
	-1.7364818e-01,
	-1.5643447e-01,
	-1.3917310e-01,
	-1.2186934e-01,
	-1.0452846e-01,
	-8.7155743e-02,
	-6.9756474e-02,
	-5.2335956e-02,
	-3.4899497e-02,
	-1.7452406e-02,
	-2.4492127e-16 };

float cos_lookup[] = {
	 1.0000000e+00,
	 9.9984770e-01,
	 9.9939083e-01,
	 9.9862953e-01,
	 9.9756405e-01,
	 9.9619470e-01,
	 9.9452190e-01,
	 9.9254615e-01,
	 9.9026807e-01,
	 9.8768834e-01,
	 9.8480775e-01,
	 9.8162718e-01,
	 9.7814760e-01,
	 9.7437006e-01,
	 9.7029573e-01,
	 9.6592583e-01,
	 9.6126170e-01,
	 9.5630476e-01,
	 9.5105652e-01,
	 9.4551858e-01,
	 9.3969262e-01,
	 9.3358043e-01,
	 9.2718385e-01,
	 9.2050485e-01,
	 9.1354546e-01,
	 9.0630779e-01,
	 8.9879405e-01,
	 8.9100652e-01,
	 8.8294759e-01,
	 8.7461971e-01,
	 8.6602540e-01,
	 8.5716730e-01,
	 8.4804810e-01,
	 8.3867057e-01,
	 8.2903757e-01,
	 8.1915204e-01,
	 8.0901699e-01,
	 7.9863551e-01,
	 7.8801075e-01,
	 7.7714596e-01,
	 7.6604444e-01,
	 7.5470958e-01,
	 7.4314483e-01,
	 7.3135370e-01,
	 7.1933980e-01,
	 7.0710678e-01,
	 6.9465837e-01,
	 6.8199836e-01,
	 6.6913061e-01,
	 6.5605903e-01,
	 6.4278761e-01,
	 6.2932039e-01,
	 6.1566148e-01,
	 6.0181502e-01,
	 5.8778525e-01,
	 5.7357644e-01,
	 5.5919290e-01,
	 5.4463904e-01,
	 5.2991926e-01,
	 5.1503807e-01,
	 5.0000000e-01,
	 4.8480962e-01,
	 4.6947156e-01,
	 4.5399050e-01,
	 4.3837115e-01,
	 4.2261826e-01,
	 4.0673664e-01,
	 3.9073113e-01,
	 3.7460659e-01,
	 3.5836795e-01,
	 3.4202014e-01,
	 3.2556815e-01,
	 3.0901699e-01,
	 2.9237170e-01,
	 2.7563736e-01,
	 2.5881905e-01,
	 2.4192190e-01,
	 2.2495105e-01,
	 2.0791169e-01,
	 1.9080900e-01,
	 1.7364818e-01,
	 1.5643447e-01,
	 1.3917310e-01,
	 1.2186934e-01,
	 1.0452846e-01,
	 8.7155743e-02,
	 6.9756474e-02,
	 5.2335956e-02,
	 3.4899497e-02,
	 1.7452406e-02,
	 0.0,
	-1.7452406e-02,
	-3.4899497e-02,
	-5.2335956e-02,
	-6.9756474e-02,
	-8.7155743e-02,
	-1.0452846e-01,
	-1.2186934e-01,
	-1.3917310e-01,
	-1.5643447e-01,
	-1.7364818e-01,
	-1.9080900e-01,
	-2.0791169e-01,
	-2.2495105e-01,
	-2.4192190e-01,
	-2.5881905e-01,
	-2.7563736e-01,
	-2.9237170e-01,
	-3.0901699e-01,
	-3.2556815e-01,
	-3.4202014e-01,
	-3.5836795e-01,
	-3.7460659e-01,
	-3.9073113e-01,
	-4.0673664e-01,
	-4.2261826e-01,
	-4.3837115e-01,
	-4.5399050e-01,
	-4.6947156e-01,
	-4.8480962e-01,
	-5.0000000e-01,
	-5.1503807e-01,
	-5.2991926e-01,
	-5.4463904e-01,
	-5.5919290e-01,
	-5.7357644e-01,
	-5.8778525e-01,
	-6.0181502e-01,
	-6.1566148e-01,
	-6.2932039e-01,
	-6.4278761e-01,
	-6.5605903e-01,
	-6.6913061e-01,
	-6.8199836e-01,
	-6.9465837e-01,
	-7.0710678e-01,
	-7.1933980e-01,
	-7.3135370e-01,
	-7.4314483e-01,
	-7.5470958e-01,
	-7.6604444e-01,
	-7.7714596e-01,
	-7.8801075e-01,
	-7.9863551e-01,
	-8.0901699e-01,
	-8.1915204e-01,
	-8.2903757e-01,
	-8.3867057e-01,
	-8.4804810e-01,
	-8.5716730e-01,
	-8.6602540e-01,
	-8.7461971e-01,
	-8.8294759e-01,
	-8.9100652e-01,
	-8.9879405e-01,
	-9.0630779e-01,
	-9.1354546e-01,
	-9.2050485e-01,
	-9.2718385e-01,
	-9.3358043e-01,
	-9.3969262e-01,
	-9.4551858e-01,
	-9.5105652e-01,
	-9.5630476e-01,
	-9.6126170e-01,
	-9.6592583e-01,
	-9.7029573e-01,
	-9.7437006e-01,
	-9.7814760e-01,
	-9.8162718e-01,
	-9.8480775e-01,
	-9.8768834e-01,
	-9.9026807e-01,
	-9.9254615e-01,
	-9.9452190e-01,
	-9.9619470e-01,
	-9.9756405e-01,
	-9.9862953e-01,
	-9.9939083e-01,
	-9.9984770e-01,
	-1.0000000e+00,
	-9.9984770e-01,
	-9.9939083e-01,
	-9.9862953e-01,
	-9.9756405e-01,
	-9.9619470e-01,
	-9.9452190e-01,
	-9.9254615e-01,
	-9.9026807e-01,
	-9.8768834e-01,
	-9.8480775e-01,
	-9.8162718e-01,
	-9.7814760e-01,
	-9.7437006e-01,
	-9.7029573e-01,
	-9.6592583e-01,
	-9.6126170e-01,
	-9.5630476e-01,
	-9.5105652e-01,
	-9.4551858e-01,
	-9.3969262e-01,
	-9.3358043e-01,
	-9.2718385e-01,
	-9.2050485e-01,
	-9.1354546e-01,
	-9.0630779e-01,
	-8.9879405e-01,
	-8.9100652e-01,
	-8.8294759e-01,
	-8.7461971e-01,
	-8.6602540e-01,
	-8.5716730e-01,
	-8.4804810e-01,
	-8.3867057e-01,
	-8.2903757e-01,
	-8.1915204e-01,
	-8.0901699e-01,
	-7.9863551e-01,
	-7.8801075e-01,
	-7.7714596e-01,
	-7.6604444e-01,
	-7.5470958e-01,
	-7.4314483e-01,
	-7.3135370e-01,
	-7.1933980e-01,
	-7.0710678e-01,
	-6.9465837e-01,
	-6.8199836e-01,
	-6.6913061e-01,
	-6.5605903e-01,
	-6.4278761e-01,
	-6.2932039e-01,
	-6.1566148e-01,
	-6.0181502e-01,
	-5.8778525e-01,
	-5.7357644e-01,
	-5.5919290e-01,
	-5.4463904e-01,
	-5.2991926e-01,
	-5.1503807e-01,
	-5.0000000e-01,
	-4.8480962e-01,
	-4.6947156e-01,
	-4.5399050e-01,
	-4.3837115e-01,
	-4.2261826e-01,
	-4.0673664e-01,
	-3.9073113e-01,
	-3.7460659e-01,
	-3.5836795e-01,
	-3.4202014e-01,
	-3.2556815e-01,
	-3.0901699e-01,
	-2.9237170e-01,
	-2.7563736e-01,
	-2.5881905e-01,
	-2.4192190e-01,
	-2.2495105e-01,
	-2.0791169e-01,
	-1.9080900e-01,
	-1.7364818e-01,
	-1.5643447e-01,
	-1.3917310e-01,
	-1.2186934e-01,
	-1.0452846e-01,
	-8.7155743e-02,
	-6.9756474e-02,
	-5.2335956e-02,
	-3.4899497e-02,
	-1.7452406e-02,
	-1.8369095e-16,
	 1.7452406e-02,
	 3.4899497e-02,
	 5.2335956e-02,
	 6.9756474e-02,
	 8.7155743e-02, 
	 1.0452846e-01,
	 1.2186934e-01,
	 1.3917310e-01,
	 1.5643447e-01,
	 1.7364818e-01,
	 1.9080900e-01,
	 2.0791169e-01,
	 2.2495105e-01,
	 2.4192190e-01,
	 2.5881905e-01,
	 2.7563736e-01,
	 2.9237170e-01,
	 3.0901699e-01,
	 3.2556815e-01,
	 3.4202014e-01,
	 3.5836795e-01,
	 3.7460659e-01,
	 3.9073113e-01,
	 4.0673664e-01,
	 4.2261826e-01,
	 4.3837115e-01,
	 4.5399050e-01,
	 4.6947156e-01,
	 4.8480962e-01,
	 5.0000000e-01,
	 5.1503807e-01,
	 5.2991926e-01,
	 5.4463904e-01,
	 5.5919290e-01,
	 5.7357644e-01,
	 5.8778525e-01,
	 6.0181502e-01,
	 6.1566148e-01,
	 6.2932039e-01,
	 6.4278761e-01,
	 6.5605903e-01,
	 6.6913061e-01,
	 6.8199836e-01,
	 6.9465837e-01,
	 7.0710678e-01,
	 7.1933980e-01,
	 7.3135370e-01,
	 7.4314483e-01,
	 7.5470958e-01,
	 7.6604444e-01,
	 7.7714596e-01,
	 7.8801075e-01,
	 7.9863551e-01,
	 8.0901699e-01,
	 8.1915204e-01,
	 8.2903757e-01,
	 8.3867057e-01,
	 8.4804810e-01,
	 8.5716730e-01,
	 8.6602540e-01,
	 8.7461971e-01,
	 8.8294759e-01,
	 8.9100652e-01,
	 8.9879405e-01,
	 9.0630779e-01,
	 9.1354546e-01,
	 9.2050485e-01,
	 9.2718385e-01,
	 9.3358043e-01,
	 9.3969262e-01,
	 9.4551858e-01,
	 9.5105652e-01,
	 9.5630476e-01,
	 9.6126170e-01,
	 9.6592583e-01,
	 9.7029573e-01,
	 9.7437006e-01,
	 9.7814760e-01,
	 9.8162718e-01,
	 9.8480775e-01,
	 9.8768834e-01,
	 9.9026807e-01,
	 9.9254615e-01,
	 9.9452190e-01,
	 9.9619470e-01,
	 9.9756405e-01,
	 9.9862953e-01,
	 9.9939083e-01,
	 9.9984770e-01,
	 1.0000000e+00};

float fast_sin(float in)
{
if ((angle = (int)(in * 180.0 / PI) % 360) < 0)
	angle = 360 + angle;
return(sin_lookup[angle]);
}

float Dfast_sin(int in)
{
if ((angle = in % 360) < 0)
	angle += 360;
return(sin_lookup[angle]);
}

float fast_cos(float in)
{
if ((angle = (int)(in * 180.0 / PI) % 360) < 0)
	angle = 360 + angle;
return(cos_lookup[angle]);
}

float Dfast_cos(int in)
{
if ((angle = in % 360) < 0)
	angle += 360;
return(cos_lookup[angle]);
}
